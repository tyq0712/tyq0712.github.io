<h3 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a>Statement</h3><p>​    给一个积性函数：</p>
<script type="math/tex; mode=display">
A:
A(0) = 1,\\
A(p^k) = (p^k+1)</script><p>​    求 $A$  的前缀和。</p>
<p>$n\le 10^{13}$</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><script type="math/tex; mode=display">
=\sum_i i\sum_{i*j\le n} [gcd(i,j)=1]\\
=\sum_i i\sum_{i*j\le n} \sum_{d|i,d|j}\mu(d)
\\
=\sum_d \mu(d)*d\sum_i i\sum_j[d^2ij\le n]
\\
=\sum_d \mu(d)*d\sum_i i\lfloor \frac {n}{d^2i}\rfloor</script><p>可以 $n^{2/3}$</p>
<p>实际上暴力就是根号 log（我们考虑枚举次数是 $\large\sum \sqrt{\frac{n}{d^2}}$）</p>
<p>瓶颈在 $\text{I}*\text{Id}$ 的前缀和。</p>
