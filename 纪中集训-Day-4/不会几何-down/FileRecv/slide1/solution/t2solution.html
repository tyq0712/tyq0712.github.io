<p><a href="http://codeforces.com/problemset/problem/755/G">http://codeforces.com/problemset/problem/755/G</a></p>
<p>原题是这个。</p>
<h3 id="？pts"><a href="#？pts" class="headerlink" title="？pts"></a>？pts</h3><p>倍增FFT。</p>
<p>如果你常数足够牛逼可以卡过 70 pts。</p>
<h3 id="70pts"><a href="#70pts" class="headerlink" title="70pts"></a>70pts</h3><p><del>随机一个代码粘上来</del></p>
<p>首先你们会发现一个 $F_i = (1+x)F_{i-1} + (1+x)F_{i-2}$</p>
<p>这样实际上是可以解出来通项公式的，复杂度一个log。</p>
<p>如果你常数足够牛逼（也许）可以卡过100pts。</p>
<h3 id="100pts"><a href="#100pts" class="headerlink" title="100pts"></a>100pts</h3><p>枚举有多少组是两个的：</p>
<script type="math/tex; mode=display">
ans_i = \sum_j \binom{i}{j}\binom{n-j}{i}\\
\binom{n-j}{i}=\sum_k\binom{j}{k}\binom{n-k}{i-k}(-1)^k</script><p>拆组合意义，相当于 $n$ 个箱子，在前 $i$ 个中选任意个，然后在前 $n$ 个中选 $i$ 个，要求不重复。</p>
<p>容斥有多少个重复了：</p>
<script type="math/tex; mode=display">
ans_i=\sum_j (-1)^j\binom{i}{j}\binom{n-j}{i-j}2^{i-j}</script><p>一次卷积即可计算。</p>
<p>复杂度 $n\log n$。</p>
