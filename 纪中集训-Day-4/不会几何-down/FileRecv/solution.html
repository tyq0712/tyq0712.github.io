<h3 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h3><p>考虑计算每一个节点在哪一些区间 $[l,r]$ 上成为了虚树上的节点。</p>
<p>考虑 dsu on tree。这里一个节点在没有选中的情况下成为虚树节点当且仅当删去后至少三个子树包含选中的节点。</p>
<p>因而，至少有一个轻子树包含选中的节点。</p>
<p>考虑将轻子数的点按照标号排序后的结果。这里我们称虚树的颜色为其所属的子树。</p>
<p>分类讨论，在方案中中存在恰好 $1,2$ 和至少 $3$ 个虚的子树的方案。</p>
<p>这里我们预处理出来，对于每一个虚树中的节点，向前/向后最近的位于虚树/父亲子树的节点的下标即可。</p>
<p>分类讨论时讨论选取了父亲子树/重儿子子树中的几个，以及和强制选中的点编号大小关系有几个。</p>
<p>由于每一次选中轻儿子至多会形成 $7$ 个有效的区间，因而总区间个数为 $O(n\log n)$ 的。</p>
<p>利用扫描线，采用一颗线段树维护固定左端点时候的答案即可。询问用一颗求支持历史最值的线段树即可。</p>
<p>时间复杂度 $O(n\log^2n)$。</p>
<h3 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h3><p>接下来设$m=\log N$。</p>
<p>不难发现答案=$\lfloor \frac{N}{11}\rfloor$+$\lfloor \frac{N}{111}\rfloor+\cdots$</p>
<h4 id="算法1"><a href="#算法1" class="headerlink" title="算法1"></a>算法1</h4><p>我会暴力高精度除法！</p>
<p>时间复杂度$O(m^3)$</p>
<p>期望得分：$30$。</p>
<h4 id="算法2"><a href="#算法2" class="headerlink" title="算法2"></a>算法2</h4><p>我会FFT优化高精度除法！</p>
<p>时间复杂度$O(m^2\log m)$</p>
<p>期望得分：$50$。</p>
<h4 id="算法3"><a href="#算法3" class="headerlink" title="算法3"></a>算法3</h4><p>不难发现答案为$\lfloor \frac{9x}{100}+\frac{9x}{10000}+\cdots \rfloor+\cdots$</p>
<p>我们算出来所有的$\frac{9x}{10^k}$的整数部分的精确值，并且估算小数部分的值。</p>
<p>整数部分可以统计每个数字被算了多少次。小数部分直接每个数字暴力统计。这里由于保证数字随机，小数点后考虑大约 $20$ 位的误差即可。</p>
<p>时间复杂度$O(m^2+m \log m)$</p>
<p>前面的数字相加可以使用$FFT$优化，复杂度改进至$O(m \log m)$。</p>
<p>由于出题人保证数字生成非常的随机，可以直接采用$double$判断小数部分的和取整的值。</p>
<h3 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h3><p>我们设 $f_{i,j}$ 表示 $n$ 本作业中除了第 $i$ 本作业送到的时间为 $0$，其余作业送到的时间均为 $-\infty$ 的情况下，第 $j$ 本作业最早开始做的时间。</p>
<p>假设我们已知第 $i$ 本作业到达时间为 $t_i$，则我们可以确定最优情况下最后一本作业完成时间为 $\max \limits_{i=1}^n \max \limits_{j=1}^n t_i+f_{i,j}+a_j$.</p>
<p>首先这是一颗很显然的下界，其次如果我们强制让第 $i$ 本作业在 $\max \limits_{j=1}^n f_{j,i}+t_j$ 开始做的时候，根据我们构造的 $f$ 数组的性质，不难发现这是一组合法的取到下界的方案。</p>
<p>不妨设 $g_i = \max \limits_{j=1}^n f_{i,j}+a_j$，则 $g$ 可以通过一次拓扑排序求出，问题转化为：</p>
<p>给定若干组 $[L_i+g_i,R_i+g_i]$ 的随机实数，求最大值的期望。</p>
<p>这是一个经典老题，咋做都行。一个简单的做法是维护 $P_x$ 表示最大值小于 $x$ 的概率的一个多项式函数。</p>
<p>时间复杂度 $O(m+n^2)$</p>
